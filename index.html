<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEPANN'FROID - Factures Devis Relances</title>
    <meta name="description" content="Syst√®me de gestion de factures pour DEPANN'FROID">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='75' font-size='75'%3E‚ùÑÔ∏è%3C/text%3E%3C/svg%3E">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .animate-spin { animation: spin 1s linear infinite; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const Icons = {
            Send: () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>,
            Receipt: () => <svg className="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>,
            Copy: () => <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>,
            Check: () => <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>,
        };

        function App() {
            const [clientName, setClientName] = useState('');
            const [documentNumber, setDocumentNumber] = useState('');
            const [amount, setAmount] = useState('');
            const [dueDate, setDueDate] = useState('');
            const [daysOverdue, setDaysOverdue] = useState('');
            const [serviceDescription, setServiceDescription] = useState('');
            const [generatedEmail, setGeneratedEmail] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [copied, setCopied] = useState(false);

            const formatNumber = (num) => {
                return new Intl.NumberFormat('fr-FR').format(num);
            };

            const calculatePenalties = () => {
                if (!amount || !daysOverdue) return { penalties: 0, total: 0 };
                const amountNum = parseFloat(amount.replace(/\s/g, ''));
                const days = parseInt(daysOverdue);
                const penalties = Math.round((amountNum * 18 * days) / (365 * 100));
                const total = amountNum + penalties + 4800;
                return { penalties, total };
            };

            const { penalties, total } = calculatePenalties();

            const generateEmail = () => {
                if (!clientName || !documentNumber || !amount) return;
                
                setIsLoading(true);
                
                setTimeout(() => {
                    let email = `Bonjour ${clientName},

Suite √† notre intervention, veuillez trouver ci-joint la facture N¬∞ ${documentNumber} d'un montant de ${formatNumber(amount)} XPF.

Date d'√©ch√©ance : ${dueDate || '√Ä d√©finir'}`;

                    if (serviceDescription) {
                        email += `\n\nService fourni : ${serviceDescription}`;
                    }

                    if (daysOverdue && parseInt(daysOverdue) > 0) {
                        email += `\n\nNous constatons un retard de paiement de ${daysOverdue} jours.

Conform√©ment √† la loi du Pays n¬∞ 2015-4 du 14 avril 2015, les p√©nalit√©s suivantes s'appliquent :

D√âCOMPTE DES SOMMES DUES :
- Montant initial : ${formatNumber(amount)} XPF
- P√©nalit√©s de retard (18% par an) : ${formatNumber(penalties)} XPF
- Indemnit√© forfaitaire : 4 800 XPF
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
TOTAL D√õ : ${formatNumber(total)} XPF

Nous vous demandons de bien vouloir r√©gulariser votre situation dans les plus brefs d√©lais.`;
                    }

                    email += `\n\nConditions de r√®glement : Paiement √† 30 jours
En cas de retard de paiement, p√©nalit√©s exigibles de plein droit :
- Taux d'int√©r√™t : 18% par an
- Indemnit√© forfaitaire de recouvrement : 4 800 XPF

Nous restons √† votre disposition pour toute question.

Cordialement,
Lionel
G√©rant DEPANN'FROID
Moorea, Polyn√©sie Fran√ßaise`;
                    
                    setGeneratedEmail(email);
                    setIsLoading(false);
                }, 1000);
            };

            const copyToClipboard = async () => {
                await navigator.clipboard.writeText(generatedEmail);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50">
                    <div className="relative overflow-hidden">
                        <div className="absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5"></div>
                        <div className="relative max-w-7xl mx-auto px-6 py-8">
                            <div className="text-center">
                                <div className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-2xl mb-4 shadow-lg">
                                    <Icons.Receipt />
                                </div>
                                <h1 className="text-3xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent mb-2">
                                    DEPANN'FROID
                                </h1>
                                <p className="text-lg text-slate-600">
                                    Factures Devis Relances Pro
                                </p>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto px-6 pb-12">
                        <div className="grid lg:grid-cols-2 gap-6">
                            <div className="space-y-4">
                                <div className="bg-white/70 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-white/20">
                                    <h2 className="text-xl font-semibold text-slate-800 mb-4">Informations Facture</h2>
                                    <div className="space-y-3">
                                        <input
                                            type="text"
                                            value={clientName}
                                            onChange={(e) => setClientName(e.target.value)}
                                            placeholder="Nom du client *"
                                            className="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"
                                        />
                                        <div className="grid grid-cols-2 gap-3">
                                            <input
                                                type="text"
                                                value={documentNumber}
                                                onChange={(e) => setDocumentNumber(e.target.value)}
                                                placeholder="N¬∞ Facture *"
                                                className="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"
                                            />
                                            <input
                                                type="text"
                                                value={amount}
                                                onChange={(e) => setAmount(e.target.value)}
                                                placeholder="Montant XPF *"
                                                className="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"
                                            />
                                        </div>
                                        <div className="grid grid-cols-2 gap-3">
                                            <input
                                                type="text"
                                                value={dueDate}
                                                onChange={(e) => setDueDate(e.target.value)}
                                                placeholder="Date √©ch√©ance"
                                                className="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"
                                            />
                                            <input
                                                type="text"
                                                value={daysOverdue}
                                                onChange={(e) => setDaysOverdue(e.target.value)}
                                                placeholder="Jours retard"
                                                className="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"
                                            />
                                        </div>
                                        <textarea
                                            value={serviceDescription}
                                            onChange={(e) => setServiceDescription(e.target.value)}
                                            placeholder="Description du service"
                                            className="w-full h-20 p-3 border border-slate-200 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 bg-white"
                                        />
                                    </div>
                                </div>

                                {daysOverdue && amount && parseInt(daysOverdue) > 0 && (
                                    <div className="bg-gradient-to-br from-orange-50 to-red-50 rounded-xl p-5 shadow-xl border border-orange-200">
                                        <h3 className="font-semibold text-slate-800 mb-3">Calcul des P√©nalit√©s</h3>
                                        <div className="space-y-2 text-sm">
                                            <div className="flex justify-between">
                                                <span>Montant initial</span>
                                                <span className="font-semibold">{formatNumber(amount)} XPF</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span>P√©nalit√©s (18%)</span>
                                                <span className="font-semibold text-orange-600">{formatNumber(penalties)} XPF</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span>Indemnit√© forfaitaire</span>
                                                <span className="font-semibold text-orange-600">4 800 XPF</span>
                                            </div>
                                            <div className="flex justify-between pt-2 border-t-2 border-orange-300">
                                                <span className="font-bold">TOTAL D√õ</span>
                                                <span className="text-lg font-bold text-red-600">{formatNumber(total)} XPF</span>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                <button
                                    onClick={generateEmail}
                                    disabled={isLoading || !clientName || !documentNumber || !amount}
                                    className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 px-6 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3"
                                >
                                    {isLoading ? (
                                        <>
                                            <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                                            G√©n√©ration...
                                        </>
                                    ) : (
                                        <>
                                            <Icons.Send />
                                            G√©n√©rer l'Email
                                        </>
                                    )}
                                </button>
                            </div>

                            <div className="bg-white/70 backdrop-blur-sm rounded-xl p-6 shadow-xl border border-white/20">
                                <div className="flex items-center justify-between mb-4">
                                    <h2 className="text-xl font-semibold text-slate-800">Email G√©n√©r√©</h2>
                                    {generatedEmail && (
                                        <button
                                            onClick={copyToClipboard}
                                            className="flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors text-slate-700 font-medium text-sm"
                                        >
                                            {copied ? (
                                                <>
                                                    <Icons.Check />
                                                    Copi√© !
                                                </>
                                            ) : (
                                                <>
                                                    <Icons.Copy />
                                                    Copier
                                                </>
                                            )}
                                        </button>
                                    )}
                                </div>
                                
                                {generatedEmail ? (
                                    <div className="bg-white/80 rounded-xl p-6 border border-slate-200 max-h-[600px] overflow-y-auto">
                                        <pre className="whitespace-pre-wrap font-sans text-slate-700 leading-relaxed text-sm">
                                            {generatedEmail}
                                        </pre>
                                    </div>
                                ) : (
                                    <div className="flex flex-col items-center justify-center h-64 text-slate-400">
                                        <Icons.Receipt />
                                        <p className="text-lg mt-4">Votre email appara√Ætra ici</p>
                                        <p className="text-sm mt-2">Remplissez les informations et g√©n√©rez</p>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100">
                            <h3 className="font-semibold text-slate-800 mb-3 text-center">üìã Informations L√©gales - Polyn√©sie Fran√ßaise</h3>
                            <div className="grid md:grid-cols-3 gap-4 text-sm text-slate-600">
                                <div className="text-center">
                                    <div className="font-semibold text-blue-600">Taux appliqu√©</div>
                                    <div>18% par an</div>
                                </div>
                                <div className="text-center">
                                    <div className="font-semibold text-blue-600">Indemnit√© forfaitaire</div>
                                    <div>4 800 XPF par facture</div>
                                </div>
                                <div className="text-center">
                                    <div className="font-semibold text-blue-600">D√©lai de paiement</div>
                                    <div>30 jours (60 jours max)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
